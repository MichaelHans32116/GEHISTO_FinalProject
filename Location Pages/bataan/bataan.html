<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Survive Bataan – Branching Version</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f5f5;
      padding: 2rem;
      max-width: 700px;
      margin: auto;
      text-align: center;
    }

    #character img {
      width: 100px;
      border-radius: 50%;
    }

    #health-bar {
      background: #ccc;
      width: 200px;
      height: 20px;
      margin: 1rem auto;
      border-radius: 10px;
      overflow: hidden;
    }

    #health-fill {
      height: 100%;
      width: 100%;
      background-color: #28a745;
      transition: width 0.3s ease;
    }

    .button {
      background-color: #007bff;
      color: white;
      padding: 10px;
      border: none;
      border-radius: 5px;
      margin: 10px auto;
      display: block;
      width: 80%;
      max-width: 300px;
      cursor: pointer;
    }

    .result {
      font-weight: bold;
      font-size: 1.2rem;
      margin-top: 1rem;
    }

    #restart {
      display: none;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>Survive Bataan</h1>

  <div id="character">
    <img src="https://upload.wikimedia.org/wikipedia/commons/3/3b/Philippine_soldier_ww2.jpg" alt="Soldier" />
    <div id="health-bar"><div id="health-fill"></div></div>
  </div>

  <div id="scene-text"></div>
  <div id="choices"></div>
  <div class="result" id="result"></div>
  <button id="restart" onclick="startGame()">Play Again</button>

  <script>
    const scenes = {
      start: {
        text: "You're starving in the jungle of Bataan. What do you do?",
        choices: [
          { text: "Forage for roots", next: "sick", effect: -1 },
          { text: "Steal from a camp", next: "caught", effect: -2 },
          { text: "Conserve energy", next: "weak", effect: 0 },
        ]
      },
      sick: {
        text: "You find roots, but they make you sick. You're dizzy and dehydrated.",
        choices: [
          { text: "Look for clean water", next: "waterFound", effect: +1 },
          { text: "Lie down and rest", next: "hallucinate", effect: -2 }
        ]
      },
      waterFound: {
        text: "You find a muddy stream. It’s risky, but you drink. You feel stronger but may have parasites.",
        choices: [
          { text: "Push forward and find your unit", next: "survive", effect: +1 },
          { text: "Rest beside the stream", next: "die", effect: -2 }
        ]
      },
      hallucinate: {
        text: "You fall into fevered dreams. You see family. You hear voices. No one comes.",
        choices: [],
        end: `❌ <strong>You Died in Delirium</strong><br>
          Fever and disease consumed many. Their final moments were haunted by visions, alone in the jungle.`
      },
      caught: {
        text: "You're caught by guards. They beat you and take your boots.",
        choices: [
          { text: "Run into the forest", next: "escapeInjured", effect: -1 },
          { text: "Beg for mercy", next: "pleadHelp", effect: -1 }
        ]
      },
      escapeInjured: {
        text: "You escape, but thorns tear your feet. You're bleeding and weak.",
        choices: [
          { text: "Keep walking toward the mountains", next: "lost", effect: -1 },
          { text: "Climb a tree and rest", next: "die", effect: -2 }
        ]
      },
      pleadHelp: {
        text: "One guard gives you water in secret, but warns you to flee by night.",
        choices: [
          { text: "Escape under moonlight", next: "survive", effect: +1 },
          { text: "Stay hoping they change their minds", next: "captured", effect: -2 }
        ]
      },
      weak: {
        text: "You are too weak to stand. A fellow soldier finds you.",
        choices: [
          { text: "Ask for food", next: "shareFood", effect: +1 },
          { text: "Tell him to leave you", next: "abandoned", effect: -2 }
        ]
      },
      shareFood: {
        text: "He gives you hardtack and water. It’s barely enough.",
        choices: [
          { text: "Follow him back to camp", next: "survive", effect: +1 },
          { text: "Stay and rest more", next: "die", effect: -2 }
        ]
      },
      abandoned: {
        text: "He walks away, unsure what else to do. Night falls. You hear rustling.",
        choices: [],
        end: `❌ <strong>Left Behind</strong><br>
          Many soldiers were left behind — not out of cruelty, but desperation. Those left were often never seen again.`
      },
      survive: {
        text: "You survive the day. Reinforcements arrive days later.",
        choices: [],
        end: `✅ <strong>You Survived</strong><br>
          You endured hunger, fear, and exhaustion. Like many Filipino and American soldiers,
          you waited for reinforcements that never came until it was almost too late. Your resilience is
          a symbol of the real sacrifices made on Bataan.`
      },
      die: {
        text: "Your strength fades. No help comes.",
        choices: [],
        end: `❌ <strong>You Died in the Jungle</strong><br>
          Starvation and disease claimed many lives during the retreat to Bataan.
          Thousands perished alone, unrecorded, and unburied — victims not of battle, but of neglect and suffering.`
      },
      lost: {
        text: "You run but get lost in enemy territory.",
        choices: [],
        end: `⚠️ <strong>Lost Without a Trace</strong><br>
          In the chaos of war, many were separated from their units and disappeared forever.
          Your story mirrors those who went missing in action — a fate faced by hundreds in 1942.`
      },
      captured: {
        text: "You're forced into a POW group. The march begins.",
        choices: [],
        end: `⚠️ <strong>Captured & Enslaved</strong><br>
          You are now part of the Bataan Death March — a 100 km forced march under extreme heat, 
          with no food or water. Thousands died along the way. Your survival depends on endurance and luck.`
      }
    };

    let score = 0;

    function startGame() {
      score = 0;
      document.getElementById('restart').style.display = 'none';
      document.getElementById('result').innerHTML = '';
      showScene('start');
      updateHealthBar();
    }

    function showScene(sceneId) {
      const scene = scenes[sceneId];
      document.getElementById('scene-text').textContent = scene.text;
      const choicesDiv = document.getElementById('choices');
      choicesDiv.innerHTML = '';

      if (scene.end) {
        document.getElementById('result').innerHTML = scene.end;
        document.getElementById('restart').style.display = 'inline-block';

        if (["die", "lost", "captured", "hallucinate", "abandoned"].includes(sceneId)) {
          document.getElementById('health-fill').style.width = '0%';
          document.getElementById('health-fill').style.backgroundColor = '#dc3545';
        }

        return;
      }

      scene.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'button';
        btn.textContent = choice.text;
        btn.onclick = () => {
          score += choice.effect;
          updateHealthBar();
          showScene(choice.next);
        };
        choicesDiv.appendChild(btn);
      });
    }

    function updateHealthBar() {
      const percent = Math.max(0, Math.min(100, 100 + score * 20));
      document.getElementById('health-fill').style.width = percent + '%';
      document.getElementById('health-fill').style.backgroundColor =
        percent > 60 ? '#28a745' :
        percent > 30 ? '#ffc107' : '#dc3545';
    }

    startGame();
  </script>
</body>
</html>
