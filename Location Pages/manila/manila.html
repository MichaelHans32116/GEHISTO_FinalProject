<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manila - Japanese Occupation in the Philippines</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Georgia', serif;
        }
        body {
            color: #e0e0e0;
            background-color: #121212;
        }
        .navbar {
            display: flex;
            justify-content: center;
            padding: 30px 0;
            background-color: rgba(20, 20, 20, 0.9);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(139, 0, 0, 0.3);
        }
        .navbar ul {
            display: flex;
            list-style: none;
            gap: 30px;
            font-size: 1.5rem;
        }
        .navbar li {
            cursor: pointer;
            position: relative;
            color: #e0e0e0;
            transition: all 0.3s ease;
        }
        .navbar li a {
            color: #e0e0e0;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        .navbar li:hover a {
            color: #8B0000;
        }
        .navbar li.active::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 2px;
            background: red;
            bottom: -5px;
            left: 0;
        }
        header {
            color: #e0e0e0;
            padding: 100px 0;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            min-height: 70vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('./images/manila-battle.jpg') center/cover no-repeat;
            opacity: 0.7;
            z-index: -1;
        }
        .header-content {
            background-color: rgba(20, 20, 20, 0.75);
            padding: 40px;
            border-radius: 10px;
            max-width: 800px;
            margin: 0 auto;
            border: 2px solid #8B0000;
        }
        h1 {
            margin: 0;
            font-size: 2.8rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            color: white;
        }
        .subtitle {
            font-style: italic;
            margin-top: 10px;
            color: #d4c9a8;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            font-size: 1.4rem;
        }
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .content-section {
            background-color: rgba(30, 30, 30, 0.85);
            padding: 30px;
            margin-bottom: 50px;
            border: 1px solid #444;
            border-radius: 5px;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(92, 27, 26, 0.4);
        }
        .content-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(139, 0, 0, 0.4);
            border-color: #8B0000;
        }
        .content-section h2 {
            color: #d4c9a8;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #8B0000;
            font-size: 2rem;
        }
        .content-section p {
            margin-bottom: 15px;
            line-height: 1.7;
            text-align: justify;
        }
        .content-section img.modal-image {
            display: block;
            margin: 25px auto;
            max-width: 90%;
            height: auto;
            border: 2px solid #5c1b1a;
            box-shadow: 0 0 12px rgba(0, 0, 0, 0.7);
            border-radius: 4px;
        }
        .interactive-media {
            display: flex;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        .media-card {
            flex: 1;
            min-width: 300px;
            background-color: rgba(40, 40, 40, 0.85);
            border: 1px solid #444;
            border-radius: 5px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .media-card:hover {
            transform: translateY(-5px);
            border-color: #8B0000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .media-card h3 {
            color: #8B0000;
            margin-bottom: 15px;
        }
        .media-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 3px;
            margin-bottom: 15px;
            border: 1px solid #5c1b1a;
        }
        .media-card .hidden-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }
        .media-card.active .hidden-content {
            max-height: 500px;
        }
        .timeline-fader {
            position: relative;
            height: 450px;
            margin: 40px 0 15px 0;
        }
        .timeline-container {
            position: relative;
            height: 100%;
            border: 1px solid #5c1b1a;
            border-radius: 5px;
            overflow: hidden;
            background-color: rgba(0,0,0,0.3);
        }
        .timeline-item {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.8s ease;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }
        .timeline-item.active {
            opacity: 1;
        }
        .timeline-item img.modal-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            border: none;
            box-shadow: none;
            border-radius: 0;
            max-width: 100%;
            margin: 0;
        }
        .timeline-caption {
            background: linear-gradient(transparent, rgba(0,0,0,0.9) 70%);
            padding: 20px;
            color: white;
            font-weight: bold;
            text-align: center;
            z-index: 1;
        }
        .timeline-caption h4 {
            color: #d4c9a8;
            margin-bottom: 5px;
        }
        .timeline-controls {
            text-align: center;
            margin: 20px 0 10px 0;
        }
        .year-btn { 
            background-color: #333;
            color: #e0e0e0;
            border: 1px solid #8B0000;
            padding: 10px 18px;
            margin: 0 8px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        .year-btn:hover {
            background-color: #8B0000;
        }
        .year-btn.active {
            background-color: #8B0000;
            box-shadow: 0 0 10px rgba(139, 0, 0, 0.5);
        }
        .timeline-instruction {
            text-align: center;
            margin: 40px 0 20px 0; 
            font-style: italic;
            color: #aaa;
            display: block;
            clear: both;
        }
        .image-gallery-container {
             margin: 30px 0;
        }
        .gallery-filters {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .filter-btn {
            padding: 8px 18px;
            background-color: #333;
            color: #e0e0e0;
            border: 1px solid #5c1b1a;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        .filter-btn:hover, .filter-btn.active {
            background-color: #8B0000;
            border-color: #8B0000;
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        .gallery-item {
            position: relative;
            height: 220px;
            overflow: hidden;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #5c1b1a;
        }
        .gallery-item:hover {
            transform: scale(1.03);
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.4);
        }
        .gallery-item img.modal-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
            border: none;
            box-shadow: none;
            border-radius: 0;
            max-width: 100%;
            margin: 0;
        }
        .gallery-item:hover img.modal-image {
            transform: scale(1.1);
        }
        .gallery-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.9) 70%);
            padding: 12px;
            color: white;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            font-size: 0.9rem;
            text-align: center;
        }
        .gallery-item:hover .gallery-caption {
            transform: translateY(0);
        }
        img.battle-map {
            width: 100%;
            max-width: 800px;
            margin: 25px auto;
            display: block;
            border: 2px solid #5c1b1a;
            border-radius: 4px;
        }
        .interactive-quote {
            background-color: rgba(60, 30, 30, 0.4);
            border-left: 4px solid #8B0000;
            padding: 20px;
            margin: 25px 0;
            font-style: italic;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 0 4px 4px 0;
        }
        .interactive-quote:hover {
            transform: translateX(5px);
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
            background-color: rgba(70, 35, 35, 0.5);
        }
        .interactive-quote p {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        .interactive-quote .full-quote {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed rgba(224, 224, 224, 0.3);
        }
        .interactive-quote.expanded .full-quote {
            max-height: 500px;
        }
        .quote-author {
            text-align: right;
            font-weight: bold;
            color: #d4c9a8;
            margin-top: 10px;
            font-style: normal;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            padding: 3rem 5%;
            background-color: rgba(139, 0, 0, 0.8);
            text-align: center;
            margin: 50px auto;
            border-radius: 8px;
            max-width: 1200px;
        }
        .stat-item {
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        .stat-item:hover {
            transform: scale(1.05);
        }
        .stat-number {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: white;
        }
        .stat-label {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.95);
        }
        .back-button {
            display: inline-block;
            padding: 12px 25px;
            background-color: #5c1b1a;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 25px;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-weight: bold;
            text-align: center;
        }
        .back-button:hover {
            background-color: #8B0000;
            transform: translateY(-2px);
        }
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 35px;
            background-color: rgba(10, 10, 10, 0.85);
            color: #b0b0b0;
            border-top: 3px solid #8B0000;
        }
        footer p {
            margin: 5px 0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.92);
            z-index: 1000;
            overflow: auto;
            padding-top: 50px;
        }
        .modal-content {
            margin: auto;
            display: block;
            max-width: 85%;
            max-height: 85vh;
            border: 3px solid #8B0000;
            animation: zoom 0.3s ease-out;
            background-color: #121212;
        }
        .close {
            position: absolute;
            top: 20px;
            right: 35px;
            color: #8B0000;
            font-size: 45px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.2s ease;
            line-height: 1;
        }
        .close:hover {
            color: #e0e0e0;
            transform: scale(1.1);
        }
        @keyframes zoom {
            from {transform: scale(0.7) translateY(-20px); opacity: 0;}
            to {transform: scale(1) translateY(0); opacity: 1;}
        }
        .then-now-slider-container {
            max-width: 800px;
            margin: 40px auto;
            border: 2px solid #5c1b1a;
            border-radius: 5px;
            padding: 10px;
            background-color: rgba(0,0,0,0.3);
        }
        .then-now-slider {
            position: relative;
            width: 100%;
            overflow: hidden;
            aspect-ratio: 16 / 9;
            border-radius: 3px;
            user-select: none; 
        }
        .then-now-slider.dragging {
            cursor: ew-resize;
        }
        .then-now-slider .then-image,
        .then-now-slider .now-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
        }
        .then-now-slider .now-image-wrapper {
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            overflow: hidden;
            z-index: 2;
            border-left: 3px solid white;
            box-sizing: border-box;
        }
        .then-now-slider .slider-handle {
            position: absolute;
            top: 0;
            left: 50%;
            width: 4px;
            height: 100%;
            background-color: white;
            z-index: 3;
            transform: translateX(-50%);
            cursor: ew-resize;
        }
        .then-now-slider input[type="range"].slider-control {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            margin: 0;
            opacity: 0;
            cursor: ew-resize;
            z-index: 4;
        }
        .slider-instructions {
            text-align: center;
            color: #bbb;
            font-style: italic;
            margin-top: 10px;
        }
        .image-hotspots-container {
            position: relative;
            display: block;
            max-width: 90%;
            margin: 25px auto;
        }
        .image-hotspots-container .base-image-for-hotspots {
            display: block;
            width: 100%;
            height: auto;
            border: 2px solid #5c1b1a;
            box-shadow: 0 0 12px rgba(0, 0, 0, 0.7);
            border-radius: 4px;
        }
        .hotspot {
            position: absolute;
            width: 22px;
            height: 22px;
            background-color: rgba(220, 50, 50, 0.8);
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            box-shadow: 0 0 0 0 rgba(220, 50, 50, 0.7);
            transform: translate(-50%, -50%);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            z-index: 5;
        }
        .hotspot:hover {
            transform: translate(-50%, -50%) scale(1.2);
            box-shadow: 0 0 8px 2px rgba(220, 50, 50, 0.7);
        }
        .hotspot.active {
             background-color: rgba(255, 80, 80, 1);
             box-shadow: 0 0 10px 3px rgba(255, 80, 80, 0.9);
        }
        .hotspot-tooltip {
            position: absolute;
            background-color: rgba(20, 20, 20, 0.95);
            color: #e0e0e0;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid #8B0000;
            display: none;
            z-index: 10;
            max-width: 220px;
            font-size: 0.9em;
            line-height: 1.4;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            pointer-events: none;
        }
        .references-section {
            background-color: rgba(30, 30, 30, 0.7);
            padding: 30px;
            margin-top: 40px;
            margin-bottom: 0px;
            border: 1px solid #444;
            border-radius: 5px;
            color: #c0c0c0;
        }
        .references-section h2 {
            color: #d4c9a8;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #8B0000;
            font-size: 1.8rem;
        }
        .references-section ul {
            list-style-type: disc;
            margin-left: 25px;
            line-height: 1.6;
        }
        .references-section li {
            margin-bottom: 8px;
        }
        .references-section a {
            color: #ff7f7f;
            text-decoration: none;
        }
        .references-section a:hover {
            text-decoration: underline;
            color: #ff9f9f;
        }
        @media (max-width: 768px) {
            .navbar ul {
                font-size: 1.2rem;
                gap: 20px;
            }
            h1 {
                font-size: 2.2rem;
            }
            .subtitle {
                font-size: 1.2rem;
            }
            .timeline-fader {
                height: 380px;
            }
            .stats {
                grid-template-columns: 1fr 1fr;
            }
             .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            .content-section img.modal-image,
            .image-hotspots-container {
                max-width: 100%;
            }
            img.battle-map {
                 max-width: 100%;
            }
            .then-now-slider-container {
                padding: 5px;
            }
            .hotspot {
                width: 18px;
                height: 18px;
            }
            .references-section h2 {
                font-size: 1.6rem;
            }
        }
        @media (max-width: 480px) {
            .navbar ul {
                gap: 12px;
                font-size: 1rem;
            }
            header {
                min-height: 50vh;
                padding: 60px 0;
            }
             .header-content {
                padding: 25px;
            }
            h1 {
                font-size: 1.8rem;
            }
            .subtitle {
                font-size: 1rem;
            }
            .stats {
                grid-template-columns: 1fr;
            }
            .media-card {
                min-width: 100%;
            }
            .timeline-fader {
                height: 320px;
            }
            .timeline-caption {
                padding: 15px;
                font-size: 0.85rem;
            }
            .timeline-controls {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
            }
            .year-btn {
                padding: 8px 12px;
                margin: 3px;
                font-size: 0.8rem;
            }
            .gallery-grid {
                grid-template-columns: 1fr;
            }
            .filter-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            .back-button {
                padding: 10px 20px;
                font-size: 0.9rem;
                width: 100%;
            }
            .then-now-slider .now-image-wrapper {
                border-left-width: 2px;
            }
            .hotspot {
                width: 16px;
                height: 16px;
            }
            .hotspot-tooltip {
                max-width: 180px;
                padding: 8px;
                font-size: 0.85em;
            }
            .references-section h2 {
                font-size: 1.4rem;
            }
            .references-section ul {
                margin-left: 15px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <ul>
            <li><a href="../../index.html">Home</a></li>
            <li><a href="../../InteractiveMap/InteractiveMap.html">HistoMap</a></li>
            <li><a href="../../about/developers.html">Developers</a></li>
            <li><a href="../../VictimsPage/Victims.html">Victims</a></li>
        </ul>
    </nav>
    
    <header>
        <div class="header-content reveal">
            <h1>Manila Under Japanese Occupation</h1>
            <div class="subtitle">The Battle of Manila and the Destruction of the Pearl of the Orient (1942-1945)</div>
        </div>
    </header>
    
    <div class="container">

        <div class="content-section reveal">
            <h2>Key Stages of the Occupation</h2>
            <div class="interactive-media">
                <div class="media-card" onclick="this.classList.toggle('active')">
                    <img src="./images/manila-occupation.jpg" alt="Manila Declared Open City">
                    <h3>Open City and Initial Occupation</h3>
                    <p>Dec 1941 - Jan 1942</p>
                    <div class="hidden-content">
                        <p>Following Pearl Harbor, Japanese forces advanced rapidly. Manila was declared an open city on December 26, 1941, to prevent its destruction. Despite this, Japanese forces entered and occupied Manila on January 2, 1942, beginning a harsh period of rule.</p>
                    </div>
                </div>

                <div class="media-card" onclick="this.classList.toggle('active')">
                    <img src="./images/manila-battle.jpg" alt="Life Under Occupation">
                    <h3>Life Under Siege</h3>
                    <p>1942 - Early 1945</p>
                    <div class="hidden-content">
                        <p>Manilans endured severe economic hardship, hyperinflation, food shortages, and brutal suppression. The Japanese military administration controlled all aspects of life, leading to widespread suffering and the rise of resistance movements.</p>
                    </div>
                </div>

                <div class="media-card" onclick="this.classList.toggle('active')">
                    <img src="./images/manila-ruins.jpg" alt="Liberation and Destruction">
                    <h3>The Battle for Liberation</h3>
                    <p>February - March 1945</p>
                    <div class="hidden-content">
                        <p>The month-long Battle of Manila to liberate the city resulted in its catastrophic destruction and the massacre of an estimated 100,000 civilians by retreating Japanese forces. It was one of the deadliest urban battles of World War II.</p>
                    </div>
                </div>
            </div>
            <p style="text-align:center; font-style:italic; color: #bbb;">Click on each card to reveal more information about these key stages.</p>
        </div>

        <div class="content-section reveal">
            <h2>Japanese Occupation of Manila</h2>
            <img src="./images/manila-occupation.jpg" alt="Japanese occupation of Manila" class="modal-image">
            <p>Following the attack on Pearl Harbor on December 8, 1941, Japanese forces quickly advanced on Manila. By December 26, 1941, Manila was declared an open city by General Douglas MacArthur to prevent its destruction, but the Japanese still occupied it on January 2, 1942.</p>
            <p>Under Japanese rule, Manila suffered severe economic hardship. The Japanese took control of all banks and the money supply, resulting in hyperinflation. The sugar industry was completely shut down, and lack of fuel, poor transportation, and ineffective policies led to food shortages. By 1945, the GDP had shrunk by 70%, and the price of rice skyrocketed from ₱6 to ₱60 per kilo.</p>
            
            <div class="interactive-quote" onclick="this.classList.toggle('expanded')">
                <p>"The Pearl of the Orient was transformed into a city of fear and deprivation under Japanese occupation."</p>
                <div class="full-quote">
                    <p>The once-vibrant capital became a shadow of its former self, with daily life marked by uncertainty and the heavy hand of the occupying forces.</p>
                </div>
                <div class="quote-author">- Historical Account, 1947</div>
            </div>
            
            <p>Filipinos were forced to work under miserable conditions with insufficient food and healthcare. The standard of living deteriorated rapidly due to rationing and failing industries. The occupation resulted in severe economic suffering through inflation, food shortages, forced labor, and rationing.</p>
        </div>
        
        <div class="content-section reveal">
            <h2>The Battle of Manila (February 1945)</h2>
            <img src="./images/manila-battle.jpg" alt="Battle of Manila" class="modal-image">
            <p>The 29-day battle to retake Manila in February 1945 proved a fight unlike any other in the Pacific War - a bloody urban brawl that forced American soldiers to battle block by block, house by house, and even room by room. The end result was the catastrophic destruction of the city and a rampage by Japanese troops that terrorized the civilian population.</p>
            <p>Landmarks were demolished, houses torched, countless women raped, and their husbands and children murdered. An estimated 100,000 civilians were slain in a massacre as heinous as the Rape of Nanking. The battle left Manila in ruins, with its water, electricity, and transportation systems destroyed.</p>
            
            <img src="./images/manila-map.jpg" alt="Battle of Manila Map" class="battle-map modal-image">
            
            <h3 style="color: #d4c9a8; margin-top: 30px; text-align:center; font-size: 1.5rem;">Phases of the Battle</h3>
            <div class="timeline-fader">
                <div class="timeline-container">
                    <div class="timeline-item active" data-year="phase1">
                        <img src="./images/manila-occupation.jpg" alt="Phase 1: US Entry" class="modal-image">
                        <div class="timeline-caption">
                            <h4>Phase 1: Initial Advance</h4>
                            <p><strong>Feb 3-7, 1945:</strong> The 1st Cavalry Division reached Manila, liberating internees at Santo Tomás. The 37th Infantry Division advanced, securing the water system but facing heavy resistance.</p>
                        </div>
                    </div>
                    <div class="timeline-item" data-year="phase2">
                        <img src="./images/intramuros-ruins.jpg" alt="Phase 2: Crossing the Pasig" class="modal-image">
                        <div class="timeline-caption">
                             <h4>Phase 2: Crossing the Pasig</h4>
                            <p><strong>Feb 7-12, 1945:</strong> U.S. forces controlled Manila north of the Pasig River. Japanese retreated, destroying bridges. The 37th ID crossed the Pasig under fire, establishing a bridgehead south.</p>
                        </div>
                    </div>
                    <div class="timeline-item" data-year="phase3">
                        <img src="./images/ermita-damage.jpg" alt="Phase 3: Urban Combat" class="modal-image">
                        <div class="timeline-caption">
                            <h4>Phase 3: Brutal Urban Combat</h4>
                            <p><strong>Feb 13-22, 1945:</strong> Intense building-by-building fighting. U.S. troops encountered strongpoints at Provisor Island, Paco Railroad Station, and the New Police Station, requiring heavy support.</p>
                        </div>
                    </div>
                    <div class="timeline-item" data-year="phase4">
                        <img src="./images/manila-atrocities.jpg" alt="Phase 4: Assault on Intramuros" class="modal-image">
                        <div class="timeline-caption">
                            <h4>Phase 4: Assault on Intramuros</h4>
                            <p><strong>Feb 23-26, 1945:</strong> Final assault on Intramuros after bombardment. The 129th Infantry faced tough fighting at Fort Santiago. Rear Admiral Iwabuchi committed suicide.</p>
                        </div>
                    </div>
                    <div class="timeline-item" data-year="phase5">
                        <img src="./images/manila-ruins.jpg" alt="Phase 5: Final Liberation" class="modal-image">
                        <div class="timeline-caption">
                            <h4>Phase 5: Securing the City</h4>
                            <p><strong>Feb 26 - Mar 3, 1945:</strong> Japanese remnants held out in government buildings, requiring heavy artillery. On March 3, Lt. Gen. Griswold declared Manila liberated.</p>
                        </div>
                    </div>
                </div>
                <div class="timeline-controls">
                    <button class="year-btn active" data-year="phase1">Phase 1 (Feb 3-7)</button>
                    <button class="year-btn" data-year="phase2">Phase 2 (Feb 7-12)</button>
                    <button class="year-btn" data-year="phase3">Phase 3 (Feb 13-22)</button>
                    <button class="year-btn" data-year="phase4">Phase 4 (Feb 23-26)</button>
                    <button class="year-btn" data-year="phase5">Phase 5 (Feb 26-Mar 3)</button>
                </div>
            </div>
            <p class="timeline-instruction">Click the buttons to explore key phases of the Battle of Manila.</p>
        </div>

        <div class="content-section reveal">
            <h2>Manila: Then and Now</h2>
            <p>The Battle of Manila left indelible scars on the city's landscape. Many historical buildings and districts were decimated. While reconstruction has occurred over the decades, the memory of the past remains. Use the slider below to compare a scene from the ruins of 1945 with a more contemporary view of a similar area or a rebuilt landmark.</p>
            <div class="then-now-slider-container">
                <div class="then-now-slider" id="manila-comparison">
                    <img src="./images/manila-then.jpg" alt="Manila in 1945" class="then-image">
                    <div class="now-image-wrapper">
                        <img src="./images/manila-now.jpg" alt="Manila Today" class="now-image">
                    </div>
                    <input type="range" min="0" max="100" value="50" class="slider-control" aria-label="Manila then and now comparison slider">
                </div>
                <p class="slider-instructions">Drag the slider to compare the images.</p>
            </div>
            <p>Note: The "Then" image depicts the general devastation. The "Now" image is representative of Manila's recovery and modernization. Exact location matches can be challenging due to extensive rebuilding.</p>
        </div>
        
        <div class="content-section reveal">
            <h2>Japanese Atrocities in Manila</h2>
            <img src="./images/manila-atrocities.jpg" alt="Manila atrocities" class="modal-image">
            <p>The Battle of Manila highlighted the extreme brutality of Japanese forces toward civilians. Japanese troops used hospitals and churches for cover, knowing Americans would hesitate to fire. Mass executions, rape, and other brutal tactics were employed as they attempted to resist the American advance.</p>
            
            <div class="interactive-quote" onclick="this.classList.toggle('expanded')">
                <p>"The Japanese soldiers committed brutal acts against the Filipino people, including mass executions, torture, forced labor, and widespread sexual violence."</p>
                <div class="full-quote">
                    <p>Many women were raped, and entire villages were massacred. The scale of the atrocities committed during the final days of the occupation left an indelible mark on the city's memory.</p>
                </div>
                <div class="quote-author">- Ermita Massacre Report, 1947</div>
            </div>
            
            <p>Ermita, a district in Manila, was particularly devastated. Like many other parts of the city, it became a place where people suffered even after the war ended. The trauma from the war, including sexual violence and massacres, haunted survivors for generations. Few Japanese soldiers or Filipino collaborators who committed war crimes were ever punished.</p>
            
            <div class="image-gallery-container">
                <h3 style="color: #d4c9a8; margin-bottom: 20px; text-align:center; font-size: 1.5rem;">Gallery of Destruction and Survival</h3>
                <div class="gallery-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="destruction">Destruction</button>
                    <button class="filter-btn" data-filter="survivors">Survivors</button>
                    <button class="filter-btn" data-filter="landmarks">Landmarks</button>
                </div>
                <div class="gallery-grid">
                    <div class="gallery-item" data-category="destruction">
                        <img src="./images/ermita-damage.jpg" alt="Ermita district damage" class="modal-image">
                        <div class="gallery-caption">Devastation in Ermita District</div>
                    </div>
                    <div class="gallery-item" data-category="landmarks">
                        <img src="./images/intramuros-ruins.jpg" alt="Intramuros ruins" class="modal-image">
                        <div class="gallery-caption">Ruins of Intramuros</div>
                    </div>
                    <div class="gallery-item" data-category="survivors">
                        <img src="./images/manila-survivors.jpg" alt="Manila survivors" class="modal-image">
                        <div class="gallery-caption">Survivors amidst the ruins</div>
                    </div>
                    <div class="gallery-item" data-category="destruction">
                        <img src="./images/manila-ruins.jpg" alt="City in Ruins" class="modal-image">
                        <div class="gallery-caption">Manila: A City in Ruins</div>
                    </div>
                </div>
            </div>
            <p style="text-align:center; font-style:italic; color: #aaa;">Filter images or click to view larger.</p>
        </div>

        <div class="stats reveal" id="statsManila">
            <div class="stat-item">
                <div class="stat-number" id="civilianCasualties">0</div>
                <div class="stat-label">Civilian Casualties (Est.)</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="usKilled">0</div>
                <div class="stat-label">U.S. Troops Killed</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="usWounded">0</div>
                <div class="stat-label">U.S. Troops Wounded</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="japaneseKilled">0</div>
                <div class="stat-label">Japanese Troops Killed</div>
            </div>
        </div>
        
        <div class="content-section reveal">
            <h2>Aftermath and Legacy</h2>
            
            <div class="image-hotspots-container">
                <img src="./images/manila-ruins.jpg" alt="Manila in ruins with interactive hotspots" class="base-image-for-hotspots">
                <div class="hotspot" style="top: 35%; left: 25%;" data-info="The Legislative Building, heavily damaged during the fighting, stands as a skeleton. It would later be painstakingly restored."></div>
                <div class="hotspot" style="top: 50%; left: 60%;" data-info="Piles of rubble mark what were once homes and businesses in the Ermita district, scene of horrific massacres."></div>
                <div class="hotspot" style="top: 70%; left: 40%;" data-info="A lone, damaged vehicle amidst the widespread destruction, symbolizing the collapse of daily life and infrastructure."></div>
                <div class="hotspot-tooltip"></div>
            </div>
            <p style="text-align:center; font-style:italic; color: #bbb; margin-bottom: 20px;">Hover over the red circles on the image above for more details.</p>

            <p>The battle left 1,010 U.S. troops dead, 5,565 wounded, and an estimated 16,665 Japanese killed, alongside the horrific toll of approximately 100,000 civilian casualties. Manila, once the "Pearl of the Orient," lay in complete ruins, with most of its infrastructure, historical landmarks, and homes destroyed. It was the second most devastated Allied capital in World War II, after Warsaw.</p>
            <p>The 37th Infantry Division, along with other units and civilian agencies, worked tirelessly to restore essential services like water and electricity, manage the widespread looting, and clear the city of mines and unexploded ordnance. The task of rebuilding was monumental. By March 29, the division moved on to its next campaign, leaving behind a city scarred but not broken.</p>
            
            <div class="interactive-quote" onclick="this.classList.toggle('expanded')">
                <p>"The devastation of Manila in 1945 left deep scars on the city, its residents, and the broader history of the Philippines."</p>
                <div class="full-quote">
                    <p>The battle serves as a stark reminder of the catastrophic cost of urban warfare and the profound resilience of the Filipino people who faced unimaginable horrors and then began the arduous process of rebuilding their lives and their capital.</p>
                </div>
                <div class="quote-author">- Historical Analysis, 2020</div>
            </div>
            
            <p>The Battle of Manila was not only militarily significant in the Pacific War but also stands as a testament to the horrendous toll on a civilian population caught in the crossfire. It highlighted both the depths of wartime brutality and the enduring spirit of human resilience during one of history's darkest chapters.</p>
            
            <a href="../InteractiveMap.html" class="back-button">Back to Interactive Map</a>
        </div>

        <div class="references-section reveal">
            <h2>References and Further Reading</h2>
            <ul>
                <li>Philippine Insurrection (Brief Summary). https://history.army.mil/Research/Reference-Topics/Army-Campaigns/Brief-Summaries/Philippine-Insurrection/</li>
                <li>U.S. Department of Defense (2023). Battle of Manila Foreshadowed Future Urban Warfare. https://www.defense.gov/News/Feature-Stories/Story/Article/4058939/</li>
                <li>Britannica. Battle of Manila Bay (1899). https://www.britannica.com/event/Battle-of-Manila-Bay-1899</li>
                <li>EBSCO Research Starters. Battle of Manila Bay (Military History Summary. https://www.ebsco.com/research-starters/military-history-and-science/battle-manila-bay</li>
                <li>Smithsonian National Museum of American History. The Mock Battle That Ended the Spanish-American War. https://americanhistory.si.edu/explore/stories/mock-battle-ended-spanish-american-war</li>
                <li>National Museum of the United States Army (Battle Brief): The Army and the Philippines https://www.thenmusa.org/class/battle-brief-the-army-and-the-philippines/</li>
                <li>Combined Arms Research Library (CARL). Battle of Manila (1945) Research Guide https://carlcgsc.libguides.com/manila</li>
                <li>Military History Fandom. Battle of Manila (1945) – Detailed Overview https://military-history.fandom.com/wiki/Battle_of_Manila_(1945)</li>
            </ul>
        </div>

    </div>
    
    <div class="modal" id="imageModal">
        <span class="close" title="Close">×</span>
        <img class="modal-content" id="modalImage">
    </div>

    <footer>
        <div class="container">
            <p>© 2023 Japanese Occupation in the Philippines Interactive Map</p>
            <p>Content based on research by Group 1: Alex Bumatay, Jazric Forte, Joaquin Magnantay, John Kiel Kondo, John Lio Apiado, June Platon, Lexter Limbaga, Michael Hans Magbojos, Miro Gonzales, Rob Mabilangan</p>
        </div>
    </footer>

    <script>
        function revealOnScroll() {
            const reveals = document.querySelectorAll('.reveal');
            for (let i = 0; i < reveals.length; i++) {
                const windowHeight = window.innerHeight;
                const revealTop = reveals[i].getBoundingClientRect().top;
                const revealPoint = 100;

                if (revealTop < windowHeight - revealPoint) {
                    reveals[i].classList.add('active');
                }
            }
        }

        window.addEventListener('scroll', revealOnScroll);
        window.addEventListener('load', () => {
            revealOnScroll();
            checkStats();
        });

        document.querySelectorAll('.year-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const timelineContainer = this.closest('.timeline-fader');
                timelineContainer.querySelectorAll('.year-btn').forEach(b => b.classList.remove('active'));
                timelineContainer.querySelectorAll('.timeline-item').forEach(item => item.classList.remove('active'));

                this.classList.add('active');
                const year = this.dataset.year;
                timelineContainer.querySelector(`.timeline-item[data-year="${year}"]`).classList.add('active');
            });
        });
        document.querySelectorAll('.timeline-fader').forEach(fader => {
            if (!fader.querySelector('.year-btn.active')) {
                fader.querySelector('.year-btn:first-child')?.classList.add('active');
                fader.querySelector('.timeline-item:first-child')?.classList.add('active');
            }
        });

        const filterBtns = document.querySelectorAll('.filter-btn');
        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const galleryContainer = this.closest('.image-gallery-container');
                galleryContainer.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                const filter = this.getAttribute('data-filter');
                const galleryItems = galleryContainer.querySelectorAll('.gallery-item');

                galleryItems.forEach(item => {
                    if (filter === 'all' || item.getAttribute('data-category') === filter) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        });

        const modal = document.getElementById("imageModal");
        const modalImg = document.getElementById("modalImage");
        const images = document.querySelectorAll(".modal-image");
        const closeBtn = document.getElementsByClassName("close")[0];

        images.forEach(img => {
            img.style.cursor = 'pointer';
            img.addEventListener("click", function() {
                modal.style.display = "block";
                modalImg.src = this.src;
                modalImg.alt = this.alt;
                document.body.style.overflow = 'hidden';
            });
        });

        if(closeBtn) {
            closeBtn.addEventListener("click", function() {
                modal.style.display = "none";
                document.body.style.overflow = 'auto';
            });
        }

        window.addEventListener("click", function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
                document.body.style.overflow = 'auto';
            }
        });
        
        window.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && modal.style.display === 'block') {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            if (!obj) return;

            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString();
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                } else {
                     obj.innerHTML = end.toLocaleString();
                }
            };
            window.requestAnimationFrame(step);
        }

        const statsSection = document.getElementById('statsManila');
        let statsAnimated = false;

        function checkStats() {
            if (!statsSection || statsAnimated) return;

            const sectionTop = statsSection.getBoundingClientRect().top;
            const windowHeight = window.innerHeight;

            if (sectionTop < windowHeight - 100) {
                statsAnimated = true;
                animateValue('civilianCasualties', 0, 100000, 2000);
                animateValue('usKilled', 0, 1010, 2000);
                animateValue('usWounded', 0, 5565, 2000);
                animateValue('japaneseKilled', 0, 16665, 2000);
            }
        }
        window.addEventListener('scroll', checkStats);
        
        const thenNowSliders = document.querySelectorAll('.then-now-slider');
        thenNowSliders.forEach(sliderContainer => {
            const rangeInput = sliderContainer.querySelector('input[type="range"].slider-control');
            const nowImageWrapper = sliderContainer.querySelector('.now-image-wrapper');
            const thenImage = sliderContainer.querySelector('.then-image');
            const nowImage = sliderContainer.querySelector('.now-image');

            if (!rangeInput || !nowImageWrapper || !thenImage || !nowImage) return;

            const sliderHandle = document.createElement('div');
            sliderHandle.className = 'slider-handle';
            sliderContainer.appendChild(sliderHandle);

            const updateSliderPosition = () => {
                const value = rangeInput.value;
                nowImageWrapper.style.width = `${100 - value}%`;
                sliderHandle.style.left = `${value}%`;
            };

            rangeInput.addEventListener('input', updateSliderPosition);

            let isDragging = false;
            let startX = 0;
            let startWidth = 0;

            const startDrag = (e) => {
                isDragging = true;
                sliderContainer.classList.add('dragging');
                if (e.type === 'touchstart') {
                    e.preventDefault();
                    startX = e.touches[0].clientX;
                } else {
                    startX = e.clientX;
                }
                startWidth = parseFloat(nowImageWrapper.style.width) || 50;
                document.body.style.cursor = 'ew-resize';
            };

            const stopDrag = () => {
                if (isDragging) {
                    isDragging = false;
                    sliderContainer.classList.remove('dragging');
                    document.body.style.cursor = '';
                }
            };

            const handleDrag = (e) => {
                if (!isDragging) return;
                e.preventDefault();

                let clientX;
                if (e.type === 'touchmove') {
                    clientX = e.touches[0].clientX;
                } else {
                    clientX = e.clientX;
                }

                const deltaX = clientX - startX;
                const containerWidth = sliderContainer.offsetWidth;
                const newWidth = startWidth - (deltaX / containerWidth * 100);
                const clampedWidth = Math.max(0, Math.min(100, newWidth));

                rangeInput.value = 100 - clampedWidth;
                updateSliderPosition();
            };

            sliderContainer.addEventListener('mousedown', startDrag);
            sliderContainer.addEventListener('touchstart', startDrag, { passive: false });

            document.addEventListener('mousemove', handleDrag);
            document.addEventListener('touchmove', handleDrag, { passive: false });

            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchend', stopDrag);
            document.addEventListener('mouseleave', stopDrag);

            window.addEventListener('resize', updateSliderPosition);

            updateSliderPosition();
        });

        const hotspots = document.querySelectorAll('.hotspot');
        const tooltip = document.querySelector('.hotspot-tooltip');
        const hotspotContainer = document.querySelector('.image-hotspots-container');

        if (hotspotContainer && tooltip) {
            hotspots.forEach(hotspot => {
                hotspot.addEventListener('mouseenter', function(e) {
                    hotspots.forEach(h => h.classList.remove('active'));
                    this.classList.add('active');
                    tooltip.innerHTML = this.dataset.info;
                    tooltip.style.display = 'block';
                    
                    const containerRect = hotspotContainer.getBoundingClientRect();
                    const hotspotRect = this.getBoundingClientRect();
                    
                    let topPosition = hotspotRect.top - containerRect.top + hotspotRect.height / 2;
                    let leftPosition = hotspotRect.left - containerRect.left + hotspotRect.width + 10; 

                    tooltip.style.top = topPosition + 'px';
                    tooltip.style.left = leftPosition + 'px';
                    
                    const tooltipRect = tooltip.getBoundingClientRect();

                    if (tooltipRect.right > (containerRect.right - 10) ) {
                        leftPosition = hotspotRect.left - containerRect.left - tooltipRect.width - 10;
                    }
                     if (leftPosition < (containerRect.left - hotspotRect.left + containerRect.left +10) ) { 
                        leftPosition = hotspotRect.left - containerRect.left + hotspotRect.width + 10;
                    }
                    if (tooltipRect.bottom > (containerRect.bottom -10) ) {
                        topPosition = hotspotRect.top - containerRect.top - tooltipRect.height - 5; 
                    }
                     if (topPosition < 0) {
                        topPosition = hotspotRect.top - containerRect.top + hotspotRect.height + 5;
                    }

                    tooltip.style.top = topPosition + 'px';
                    tooltip.style.left = leftPosition + 'px';

                });
                hotspot.addEventListener('mouseleave', function() {
                    this.classList.remove('active');
                    tooltip.style.display = 'none';
                });
            });
        }
    </script>
</body>
</html>